# @package _global_
# PGD-EOT attack configuration for CIFAR-10 randomized smoothing defense.

defaults:
  - base/defaults
  - override hydra/launcher: submitit_slurm_cifar10
  - _self_

experiment_type: "pgd_eot_attack"

attack:
  # Attack objective: untargeted by default (flip away from true label)
  targeted: false

  # PGD hyperparameters
  norm: "l2"
  # Attack epsilon is set per-sample to the certified radius (optionally capped):
  max_attack_eps_l2: null
  # Use either absolute step_size, or step_size_rel * eps_per_sample:
  step_size: 0.01
  step_size_rel: null
  num_iter: 100
  eot_samples: 20
  random_start: true
  early_stop: true

  # Evaluation / bookkeeping
  attack_only_if_correct: true
  # Certification parameters (override global N0/N/alpha/batch_size if desired)
  cert_N0: 100
  cert_N: 100000
  cert_alpha: 0.001
  cert_batch_size: 200
  # Smoothed prediction at x_adv for success criterion
  eval_n: 10000
  eval_alpha: 0.001
  eval_batch_size: 200
  min_cert_radius_l2: 0.0
  sigma_target_multiplier: 2.0
  log_every: 10

  # Also estimate the minimum L2 radius where an adversarial exists (may be outside certified radius).
  min_radius_search:
    enabled: true
    max_eps_l2: 1.5
    coarse_steps: 10
    binary_steps: 8
    eval_n: 1000
    eval_alpha: 0.001
    eval_batch_size: 200
    num_iter: 50
    eot_samples: 10


